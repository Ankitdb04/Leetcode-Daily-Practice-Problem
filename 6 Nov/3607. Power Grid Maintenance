import java.util.*;

public class Solution {
    int[] compId;
    List<List<Integer>> adj;
    boolean[] online;
    Map<Integer, TreeSet<Integer>> compOnlineSet;

    private void dfs(int u, int cid) {
        compId[u] = cid;
        for (int v : adj.get(u)) {
            if (compId[v] == 0) {
                dfs(v, cid);
            }
        }
    }

    public int[] processQueries(int c, int[][] connections, int[][] queries) {
        // build graph
        adj = new ArrayList<>();
        for (int i = 0; i <= c; i++) {
            adj.add(new ArrayList<>());
        }
        for (int[] e : connections) {
            int u = e[0];
            int v = e[1];
            adj.get(u).add(v);
            adj.get(v).add(u);
        }

        // initialize
        compId = new int[c + 1];
        online = new boolean[c + 1];
        Arrays.fill(online, true);

        // assign component ids
        int cid = 0;
        for (int i = 1; i <= c; i++) {
            if (compId[i] == 0) {
                cid++;
                dfs(i, cid);
            }
        }

        // initialize online sets for each component
        compOnlineSet = new HashMap<>();
        for (int i = 1; i <= c; i++) {
            int id = compId[i];
            compOnlineSet.computeIfAbsent(id, k -> new TreeSet<>()).add(i);
        }

        List<Integer> ans = new ArrayList<>();

        // process each query
        for (int[] q : queries) {
            int type = q[0];
            int x = q[1];

            if (type == 1) {
                if (online[x]) {
                    ans.add(x);
                } else {
                    int comp = compId[x];
                    TreeSet<Integer> ts = compOnlineSet.get(comp);
                    if (ts == null || ts.isEmpty()) {
                        ans.add(-1);
                    } else {
                        ans.add(ts.first());
                    }
                }
            } else if (type == 2) {
                if (online[x]) {
                    online[x] = false;
                    int comp = compId[x];
                    TreeSet<Integer> ts = compOnlineSet.get(comp);
                    if (ts != null) {
                        ts.remove(x);
                    }
                }
            }
        }

        // convert List<Integer> â†’ int[]
        int[] result = new int[ans.size()];
        for (int i = 0; i < ans.size(); i++) {
            result[i] = ans.get(i);
        }

        return result;
    }
}
